<html>
  <head>
    <title>My first branch.js app</title>
    <style>
      body { margin: 0; }
      canvas { border: 1px solid #FFFFFF; }
    </style>
  </head>
  <body>
    <script src="https://cdn.rawgit.com/mrdoob/three.js/dev/build/three.min.js"></script>
    <script src="https://cdn.rawgit.com/dobobaie/branch.js/master/branch.js"></script>
    <script>
      var app, scene, areaSize = (window.innerWidth / 2) - 14;

      app = BRANCH
        .init({
          height: areaSize * 2,
          width: areaSize * 2,
          dev: true,
      }, 'example3d');

      scene = app.scene('Scene3d');

      scene
        .camera.add(BRANCH.vector(0, 0, -900), 'myCamera')
        .camera.switch('myCamera')
        .camera.rotation(BRANCH.vector(0, 179.05, 0))
      ;

      scene
        .cube(BRANCH.vector(100, 100, 100))
        .color(0xA4A4A4)
        .position(BRANCH.vector(0, 100, 0))
        .merge('3d')
      ;

      scene
        .cone(280)
        .color(0xffff00)
        .position(BRANCH.vector(-250, 0, 0))
        .merge('3d')
      ;
     
      scene
        .cylinder(180)
        .color(BRANCH.random(BRANCH.COLOR))
        .position(BRANCH.vector(250, 0, 0))
        .merge('3d')
      ;
     
      scene
        .sphere(100)
        .color(0x00ffff)
        .position(BRANCH.vector(0, -200, -50))
        .merge('3d')
      ;
     
      scene
        .get('3d', BRANCH.MERGE)
        .rotation(BRANCH.vector(5, -5, 5))
        .back()
        .light(BRANCH.vector(0, 200, 350))
        .back()
        .light(BRANCH.vector(0, 200, -200))
      ;

      scene.render();

      let frame = 0;
      let cameraAct = 'myCamera';
      app.update(function()
      {
        let scene3d = BRANCH.get('example3d').get('Scene3d');
          
        //
        let merge = scene3d.get('3d', BRANCH.MERGE);
        merge.rotation.x += 0.1;
        merge.rotation.z -= 0.1;
        merge.rotation.y -= 0.1;
      
        //
        if (frame == 60) {
          cameraAct = (cameraAct == 'myCamera' ? 'camera1' : 'myCamera');
          scene3d.camera.switch(cameraAct);
          frame = -1;
        }
        frame = frame + 1;
      });

      // Example 3
      BRANCH
        .init(function() {
          this.height = areaSize;
          this.width = areaSize;
        }, 'myBranch')
        .scene('myScene')
        .circle(60, 'myCirle')
      ;

      scene = BRANCH.get('myBranch').get('myScene');
      scene.get('myCirle').color(0x0000ff);
      scene.render();

      // Example 7
      app = BRANCH.init(function() {
        this.height = areaSize;
        this.width = areaSize * 2;
      });
      scene = app.scene();
      scene.text('BRANCH.JS').font('https://raw.githubusercontent.com/mrdoob/three.js/master/examples/fonts/optimer_bold.typeface.json').position(BRANCH.vector(-100, 0, 0)).render(); // There are already a default font but for the example I add an other one
     
      // Example 8
      BRANCH
        .init(function() {
          this.height = areaSize;
          this.width = areaSize;
        }, 'ex8')
        .scene()
        .square(BRANCH.vector(300, 300))
        .texture('http://sdg.repositoryhosting.com/git_public/sdg/sdg-blog.git/blob_plain/abced5687967687c3e429ddd18a38055d0439550:/Three-js-examples/images/crate.jpg')
        .render()
      ;

      // Example 9
       BRANCH
        .init(function() {
          this.height = areaSize;
          this.width = areaSize;
        })
        .scene()
        .camera.position(BRANCH.vector(0, 0, 100))
        .arc(95)
        .render()
      ;
      
      // Example 10          
      BRANCH
        .init(function() {
          this.height = areaSize;
          this.width = areaSize + 200;
        }, 'ex10')
        .scene()
        .camera.position(BRANCH.vector(0, 0, 10))
        .point(BRANCH.math.lemniscate()).size(4).merge('myMerge').back()
        .point(BRANCH.math.lemniscate()).size(4).rotation(BRANCH.vector(0, 0, 1.57)).merge('myMerge').back()
        .line(BRANCH.vector(-5, 0, 0).vector(5, 0, 0)).merge('myMerge').merge('myMerge2').back()
        .line(BRANCH.vector(0, -3, 0).vector(0, 3, 0)).merge('myMerge2').color(0x0000ff).render()
      ;

      app = BRANCH.get('ex10').update(function() {
        let scene = app.get('scene1');
        let merge = scene.get('myMerge2', BRANCH.MERGE);
        merge.rotation.x += 0.1;
        merge.rotation.z -= 0.1;
      });

      /*
          Examples THREE.JS mixed with BRANCH.JS
      */
      // Example 1
      app = BRANCH.init({
        height: 400,
        width: 400,
      });
      scene = app.scene();

      // START THREE.JS
      var dotGeometry = new THREE.Geometry();
      dotGeometry.vertices.push(new THREE.Vector3(0, 0, 0));
       
      var dotMaterial = new THREE.PointsMaterial({
        size: 10,
        sizeAttenuation: false,
        color: 0xffffff,
      });
      var dot = new THREE.Points(dotGeometry, dotMaterial);
      // END THREE.JS

      scene.add(dot).render().stop(); // Why stop ? Because we have to execute render to apply all mesh in scene so we stop the BRANCHE.JS draw 

      // START THREE.JS
      app.get(null, BRANCH.RENDERER).render(scene.get(null, BRANCH.SCENE), scene.get(null, BRANCH.CAMERA)); // render is three.js function => renderer.render(scene, camera)
      // END THREE.JS

      // Example 2 (usless but it works)
      THREErenderer = new THREE.WebGLRenderer();
      THREErenderer.setSize(400, 400);
      document.body.appendChild(THREErenderer.domElement);
      THREEscene = new THREE.Scene();
      THREEcamera = new THREE.PerspectiveCamera(50, 400 / 400, 1, 10000);
      THREEcamera.position.set(0, 0, 1000);
      THREEscene.add(THREEcamera);

      THREEscene.add(
        // Start BRANCH.JS
        BRANCH
          .init()
          .scene()
          .cube(BRANCH.vector(200, 200, 200), BRANCH.vector(0, 0, 0))
          .get(null, BRANCH.MESH)
        // end BRANCH.JS
      );
      
      THREErenderer.render(THREEscene, THREEcamera);
     </script>
  </body>
</html>